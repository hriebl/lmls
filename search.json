[{"path":"https://hriebl.github.io/lmls/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 Hannes Riebl Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://hriebl.github.io/lmls/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Hannes Riebl. Author, maintainer.","code":""},{"path":"https://hriebl.github.io/lmls/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Riebl H (2024). lmls: Gaussian Location-Scale Regression. R package version 0.1.0.9000, https://github.com/hriebl/lmls, https://hriebl.github.io/lmls/.","code":"@Manual{,   title = {lmls: Gaussian Location-Scale Regression},   author = {Hannes Riebl},   year = {2024},   note = {R package version 0.1.0.9000, https://github.com/hriebl/lmls},   url = {https://hriebl.github.io/lmls/}, }"},{"path":"https://hriebl.github.io/lmls/index.html","id":"lmls","dir":"","previous_headings":"","what":"Gaussian Location-Scale Regression","title":"Gaussian Location-Scale Regression","text":"lmls R package working linear models location scale. models multi-predictor regression models explanatory variables mean (= location) standard deviation (= scale) normally distributed response variable. special cases generalized additive models location, scale shape (GAMLSS), described Rigby Stasinopoulos (2005). lmls package provides functions maximum likelihood Markov chain Monte Carlo (MCMC) estimation, parametric bootstrap algorithm, diagnostic plots. written “Advanced Statistical Programming” course Göttingen University. Feel free use package vignette introduction location-scale regression, basis implementation additional inference algorithms model extensions.","code":""},{"path":"https://hriebl.github.io/lmls/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Gaussian Location-Scale Regression","text":"can install released version lmls CRAN : install development version GitHub:","code":"install.packages(\"lmls\") # install.packages(\"remotes\") remotes::install_github(\"hriebl/lmls\")"},{"path":"https://hriebl.github.io/lmls/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Gaussian Location-Scale Regression","text":"lmls package comes abdom dataset (borrows gamlss.data package). dataset consists two variables: size 610 fetuses (measurements abdominal circumference taken ultrasound scans) gestational age ranging 12 42 weeks. estimate LMLS quadratic effect babies’ age average size linear effect log-standard deviation, run code: can now use ggplot2 visualize model:","code":"library(ggplot2) library(lmls)  m <- lmls(y ~ poly(x, 2), ~ x, data = abdom) df <- abdom df$mu <- predict(m, type = \"response\", predictor = \"location\") df$sigma <- predict(m, type = \"response\", predictor = \"scale\") df$upper <- df$mu + 1.96 * df$sigma df$lower <- df$mu - 1.96 * df$sigma  ggplot(df, aes(x, y)) +   geom_point(color = \"darkgray\", size = 1) +   geom_line(aes(y = mu), linewidth = 0.7) +   geom_line(aes(y = upper), linewidth = 0.3) +   geom_line(aes(y = lower), linewidth = 0.3) +   xlab(\"Age [weeks]\") +   ylab(\"Size [mm]\")"},{"path":"https://hriebl.github.io/lmls/index.html","id":"vignette","dir":"","previous_headings":"","what":"Vignette","title":"Gaussian Location-Scale Regression","text":"details, see package vignette.","code":""},{"path":"https://hriebl.github.io/lmls/reference/abdom.html","id":null,"dir":"Reference","previous_headings":"","what":"Abdominal circumference data — abdom","title":"Abdominal circumference data — abdom","text":"abdom data frame 610 rows 2 columns. data measurements abdominal circumference (response variable) taken fetuses ultrasound scans Kings College Hospital, London, gestational ages (explanatory variable) ranging 12 42 weeks.","code":""},{"path":"https://hriebl.github.io/lmls/reference/abdom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Abdominal circumference data — abdom","text":"","code":"data(abdom)"},{"path":"https://hriebl.github.io/lmls/reference/abdom.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Abdominal circumference data — abdom","text":"data frame contains following columns: y Abdominal circumference: numeric vector. x Gestational age: numeric vector.","code":""},{"path":"https://hriebl.github.io/lmls/reference/abdom.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Abdominal circumference data — abdom","text":"Dr. Eileen M. Wright, Department Medical Statistics Evaluation, Royal Postgraduate Medical School, Du Cane Road, London, W12 0NN. abdom dataset copied lmls package gamlss.data package. gamlss.data licensed GPL 2 3.","code":""},{"path":"https://hriebl.github.io/lmls/reference/abdom.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Abdominal circumference data — abdom","text":"data used derive reference intervals Chitty et al. (1994) also comparing different reference centile methods Wright Royston (1997), also commented distribution z-scores obtained different fitted models \"somewhat longer tails normal distribution\".","code":""},{"path":"https://hriebl.github.io/lmls/reference/abdom.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Abdominal circumference data — abdom","text":"Chitty, L.S., Altman, D.G., Henderson, . Campbell, S. (1994). Charts fetal size: 3, abdominal measurement. Br. J. Obstet. Gynaec., 101: 125–131. Wright, E.M. Royston, P. (1997). comparison statistical methods age-related reference intervals. J. R. Statist. Soc. ., 160: 47–69.","code":""},{"path":"https://hriebl.github.io/lmls/reference/abdom.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Abdominal circumference data — abdom","text":"","code":"data(abdom) attach(abdom) plot(x, y)  detach(abdom)"},{"path":"https://hriebl.github.io/lmls/reference/boot.html","id":null,"dir":"Reference","previous_headings":"","what":"Parametric bootstrap for LMLS — boot","title":"Parametric bootstrap for LMLS — boot","text":"simple parametric bootstrap algorithm location-scale regression models lmls() function.","code":""},{"path":"https://hriebl.github.io/lmls/reference/boot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parametric bootstrap for LMLS — boot","text":"","code":"boot(m, num_samples = 1000, seed = NULL)"},{"path":"https://hriebl.github.io/lmls/reference/boot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parametric bootstrap for LMLS — boot","text":"m location-scale regression model lmls() function. num_samples number bootstrap samples draw. seed Either NULL integer used call set.seed() simulating response vectors.","code":""},{"path":"https://hriebl.github.io/lmls/reference/boot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parametric bootstrap for LMLS — boot","text":"lmls S3 object, see lmls(). entry boot matrices bootstrap samples added object list names location scale.","code":""},{"path":"https://hriebl.github.io/lmls/reference/boot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Parametric bootstrap for LMLS — boot","text":"","code":"library(lmls) m <- lmls(y ~ poly(x, 2), ~ x, data = abdom, light = FALSE) m <- boot(m) summary(m, type = \"boot\") #>  #> Call: #> lmls(location = y ~ poly(x, 2), scale = ~x, data = abdom, light = FALSE) #>  #> Deviance residuals: #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -3.363000 -0.701400 -0.048870 -0.000149  0.623200  4.066000  #>  #> Location coefficients (identity link): #>                Mean    2.5%     50%   97.5% #> (Intercept)  226.73  225.61  226.74  227.80 #> poly(x, 2)1 2160.38 2128.34 2160.70 2190.49 #> poly(x, 2)2  -99.44 -124.54  -99.13  -75.79 #>  #> Scale coefficients (log link): #>                Mean    2.5%     50% 97.5% #> (Intercept) 1.35639 1.16229 1.35777 1.545 #> x           0.04217 0.03563 0.04216 0.049 #>  #> Residual degrees of freedom: 605 #> Log-likelihood: -2396.41 #> AIC: 4802.82 #> BIC: 4824.89 #>  hist(m$boot$scale[, 2])"},{"path":"https://hriebl.github.io/lmls/reference/lmls-methods.html","id":null,"dir":"Reference","previous_headings":"","what":"Methods for LMLS — lmls-methods","title":"Methods for LMLS — lmls-methods","text":"couple methods location-scale regression models lmls() function provided.","code":""},{"path":"https://hriebl.github.io/lmls/reference/lmls-methods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Methods for LMLS — lmls-methods","text":"","code":"# S3 method for class 'lmls' coef(object, predictor = c(\"location\", \"scale\"), ...)  # S3 method for class 'lmls' fitted(object, predictor = c(\"location\", \"scale\"), ...)  # S3 method for class 'lmls' predict(   object,   newdata = NULL,   predictor = c(\"location\", \"scale\"),   type = c(\"link\", \"response\"),   ... )  # S3 method for class 'lmls' residuals(object, type = c(\"deviance\", \"pearson\", \"response\"), ...)  # S3 method for class 'lmls' vcov(object, predictor = c(\"location\", \"scale\"), ...)"},{"path":"https://hriebl.github.io/lmls/reference/lmls-methods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Methods for LMLS — lmls-methods","text":"object location-scale regression model lmls() function. predictor predictor work . Either \"location\" \"scale\" . , list names \"location\" \"scale\" returned. ... Currently ignored. newdata data frame (list environment) covariate values predictions computed. NULL, predictions original data returned. type Used predict() residuals(): predict(), \"link\" \"response\". \"link\" (default), \\(\\mu\\) log(\\(\\sigma\\)) returned. \"response\", \\(\\mu\\) \\(\\sigma\\) returned. residuals(), \"deviance\", \"pearson\" \"response\". \"deviance\" (default) \"pearson\", (\\(y - \\mu\\)) / \\(\\sigma\\) returned. \"response\", \\(y - \\mu\\) returned.","code":""},{"path":"https://hriebl.github.io/lmls/reference/lmls-methods.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Methods for LMLS — lmls-methods","text":"numeric vector residuals(). methods, numeric vector argument predictor either \"location\" \"scale\", list names location scale .","code":""},{"path":"https://hriebl.github.io/lmls/reference/lmls.html","id":null,"dir":"Reference","previous_headings":"","what":"Gaussian location-scale regression — lmls","title":"Gaussian location-scale regression — lmls","text":"location-scale regression model assumes normally distributed response variable one linear predictor mean (= location) one standard deviation (= scale). standard deviation mapped linear predictor log link. function sets model object estimates maximum likelihood.","code":""},{"path":"https://hriebl.github.io/lmls/reference/lmls.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gaussian location-scale regression — lmls","text":"","code":"lmls(   location,   scale = ~1,   data = environment(location),   light = TRUE,   maxit = 100,   reltol = sqrt(.Machine$double.eps) )"},{"path":"https://hriebl.github.io/lmls/reference/lmls.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gaussian location-scale regression — lmls","text":"location two-sided formula response variable LHS predictor mean RHS. scale one-sided formula predictor standard deviation RHS. data data frame (list environment) evaluate location scale formulas. light TRUE, design matrices removed estimated model save memory. maxit maximum number iterations Fisher scoring algorithm. reltol relative convergence tolerance Fisher scoring algorithm.","code":""},{"path":"https://hriebl.github.io/lmls/reference/lmls.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gaussian location-scale regression — lmls","text":"fitted linear model location scale lmls S3 object. object least following entries: y: response vector nobs: number observations df: degrees freedom df.residual: residual degrees freedom coefficients: regression coefficients list names location scale fitted.values: fitted values list names location scale residuals: response residuals coefficients: variance-covariance matrices regression coefficients list names location scale iterations: number iterations Fisher scoring algorithm took converge","code":""},{"path":"https://hriebl.github.io/lmls/reference/lmls.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Gaussian location-scale regression — lmls","text":"","code":"library(lmls) m <- lmls(y ~ poly(x, 2), ~ x, data = abdom) summary(m) #>  #> Call: #> lmls(location = y ~ poly(x, 2), scale = ~x, data = abdom) #>  #> Deviance residuals: #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> -3.363000 -0.701400 -0.048870 -0.000149  0.623200  4.066000  #>  #> Location coefficients (identity link): #>             Estimate Std. Error t value Pr(>|t|)     #> (Intercept)  226.734      0.563 402.739  < 2e-16 *** #> poly(x, 2)1 2160.371     15.228 141.871  < 2e-16 *** #> poly(x, 2)2  -99.184     12.447  -7.968 1.61e-15 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> Scale coefficients (log link): #>             Estimate Std. Error t value Pr(>|t|)     #> (Intercept) 1.356462   0.096714   14.03   <2e-16 *** #> x           0.042291   0.003388   12.48   <2e-16 *** #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> Residual degrees of freedom: 605 #> Log-likelihood: -2396.41 #> AIC: 4802.82 #> BIC: 4824.89 #>  plot(m)  qqnorm(m)"},{"path":"https://hriebl.github.io/lmls/reference/mcmc.html","id":null,"dir":"Reference","previous_headings":"","what":"MCMC inference for LMLS — mcmc","title":"MCMC inference for LMLS — mcmc","text":"Markov chain Monte Carlo (MCMC) sampler location-scale regression models lmls() function. sampler uses Gibbs updates location coefficients Riemann manifold Metropolis-adjusted Langevin algorithm (MMALA) Girolami Calderhead (2011) Fisher-Rao metric tensor scale coefficients. priors regression coefficients assumed flat. find optimal step size MMALA updates, dual averaging algorithm Nesterov (2009) used warm-phase.","code":""},{"path":"https://hriebl.github.io/lmls/reference/mcmc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MCMC inference for LMLS — mcmc","text":"","code":"mcmc(m, num_samples = 1000, num_warmup = 1000, target_accept = 0.8)"},{"path":"https://hriebl.github.io/lmls/reference/mcmc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MCMC inference for LMLS — mcmc","text":"m location-scale regression model lmls() function. num_samples number MCMC samples warm-. Defaults 1000. num_warmup number MCMC samples warm-. Defaults 1000. target_accept target acceptance rate dual averaging algorithm used warm-. Defaults 0.8.","code":""},{"path":"https://hriebl.github.io/lmls/reference/mcmc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MCMC inference for LMLS — mcmc","text":"lmls S3 object, see lmls(). entry mcmc matrices MCMC samples added object list names location scale.","code":""},{"path":"https://hriebl.github.io/lmls/reference/mcmc.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"MCMC inference for LMLS — mcmc","text":"Girolami, M. Calderhead, B. (2011), Riemann manifold Langevin Hamiltonian Monte Carlo methods. Journal Royal Statistical Society: Series B (Statistical Methodology), 73: 123-214. doi:10.1111/j.1467-9868.2010.00765.x Nesterov, Y. (2009), Primal-dual subgradient methods convex problems. Mathematical Programming, 120: 221–259. doi:10.1007/s10107-007-0149-x","code":""},{"path":"https://hriebl.github.io/lmls/reference/mcmc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"MCMC inference for LMLS — mcmc","text":"","code":"library(lmls) m <- lmls(y ~ poly(x, 2), ~ x, data = abdom, light = FALSE) m <- mcmc(m) summary(m, type = \"mcmc\") #>  #> Call: #> lmls(location = y ~ poly(x, 2), scale = ~x, data = abdom, light = FALSE) #>  #> Deviance residuals: #>     Min.  1st Qu.   Median     Mean  3rd Qu.     Max.  #> -3.48600 -0.76150 -0.05559 -0.01225  0.62090  4.20700  #>  #> Location coefficients (identity link): #>                Mean    2.5%     50%   97.5% #> (Intercept)  226.74  225.64  226.76  227.79 #> poly(x, 2)1 2160.52 2130.65 2160.82 2189.83 #> poly(x, 2)2  -98.48 -122.70  -98.78  -73.89 #>  #> Scale coefficients (log link): #>                Mean    2.5%     50% 97.5% #> (Intercept) 1.35344 1.17007 1.35456 1.538 #> x           0.04255 0.03633 0.04243 0.049 #>  #> Residual degrees of freedom: 605 #> Log-likelihood: -2397.38 #> AIC: 4804.76 #> BIC: 4826.83 #>  plot(m$mcmc$scale[, 2], type = \"l\")"},{"path":"https://hriebl.github.io/lmls/reference/reexports.html","id":null,"dir":"Reference","previous_headings":"","what":"Objects exported from other packages — reexports","title":"Objects exported from other packages — reexports","text":"objects imported packages. Follow links see documentation. generics glance, tidy","code":""},{"path":"https://hriebl.github.io/lmls/reference/summary.lmls.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary for LMLS — summary.lmls","title":"Summary for LMLS — summary.lmls","text":"Prints summary location-scale regression models lmls() function.","code":""},{"path":"https://hriebl.github.io/lmls/reference/summary.lmls.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary for LMLS — summary.lmls","text":"","code":"# S3 method for class 'lmls' summary(   object,   type = c(\"ml\", \"boot\", \"mcmc\"),   digits = max(3, getOption(\"digits\") - 3),   ... )"},{"path":"https://hriebl.github.io/lmls/reference/summary.lmls.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary for LMLS — summary.lmls","text":"object location-scale regression model lmls() function. type Either \"ml\" \"boot\" \"mcmc\": \"ml\", maximum likelihood estimates asymptotic standard errors shown. \"boot\", bootstrap estimates confidence intervals shown. \"mcmc\", Markov chain Monte Carlo (MCMC) estimates credible intervals shown. digits number digits print. ... Passed printCoefmat().","code":""},{"path":"https://hriebl.github.io/lmls/reference/summary.lmls.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary for LMLS — summary.lmls","text":"(unmodified invisible) lmls S3 object, see lmls().","code":""},{"path":"https://hriebl.github.io/lmls/news/index.html","id":"lmls-011","dir":"Changelog","previous_headings":"","what":"lmls 0.1.1","title":"lmls 0.1.1","text":"Fix failing tests waldo update. Update README vignette. Fix GitHub actions.","code":""},{"path":"https://hriebl.github.io/lmls/news/index.html","id":"lmls-010","dir":"Changelog","previous_headings":"","what":"lmls 0.1.0","title":"lmls 0.1.0","text":"CRAN release: 2022-01-18 First release.","code":""}]
